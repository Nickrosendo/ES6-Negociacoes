{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["NegociacaoService","NegociacoesView","MensagemView","NegociacaoList","Mensagem","Bind","DateHelper","Negociacao","NegociacaoController","$","document","querySelector","bind","_data","_quantidade","_valor","_negociacaoView","_listaNegociacoes","_mensagemView","_mensagem","_ordemAtual","_service","_init","lista","then","negociacoes","forEach","add","negociacao","texto","classe","catch","erro","event","preventDefault","_criaNegociacao","cadastra","mensagem","_limpaForm","importa","getNegociacaoSemana","getNegociacaoSemanaPassada","getNegociacaoSemanaRetrasada","apaga","clear","coluna","ordenaReverso","ordena","a","b","StringToDate","value","parseInt","parseFloat","focus","negociacaoController","currentInstance"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["import { NegociacaoService } from '../services/NegociacaoService'\nimport { NegociacoesView } from '../views/NegociacoesView'\nimport { MensagemView } from '../views/MensagemView'\nimport { NegociacaoList } from '../models/NegociacaoList'\nimport { Mensagem } from '../models/Mensagem'\nimport { Bind } from '../helpers/Bind' \nimport { DateHelper } from '../helpers/DateHelper' \nimport { Negociacao } from '../models/Negociacao'\n\n\nclass NegociacaoController {\n\n\tconstructor() {\n\t\tlet $ = document.querySelector.bind(document);\n\t\tthis._data = $(\"#data\");\n\t\tthis._quantidade = $(\"#quantidade\");\n\t\tthis._valor = $(\"#valor\");\n\t\tthis._negociacaoView = new NegociacoesView($('#negociacaoView'));\n\t\tthis._listaNegociacoes = new Bind(new NegociacaoList(), this._negociacaoView, ['add', 'clear', 'ordena', 'ordenaReverso']);\n\t\tthis._mensagemView = new MensagemView($('#mensagemView'));\n\t\tthis._mensagem = new Bind(new Mensagem(), this._mensagemView, ['texto', 'classe']);\n\t\tthis._ordemAtual = '';\n\t\tthis._service = new NegociacaoService();\n\t\tthis._init();\n\t\t\n\t}\n\n\t_init() {\n\n\t\tthis._service\n\t\t\t.lista()\n\t\t\t.then(negociacoes =>\n\t\t\t\tnegociacoes.forEach(negociacao => {\n\t\t\t\t\tthis._listaNegociacoes.add(negociacao)\n\t\t\t\t\tthis._mensagem.texto = \"Negociações obtidas com sucesso\";\n\t\t\t\t\tthis._mensagem.classe = \"alert alert-success\";\n\t\t\t\t})\n\t\t\t)\n\t\t\t.catch(erro => {\n\t\t\t\tthis._mensagem.texto = erro;\n\t\t\t\tthis._mensagem.classe = \"alert alert-danger\";\n\t\t\t})\n\t}\n\n\tadd(event) {\n\t\tevent.preventDefault();\n\t\tlet negociacao = this._criaNegociacao();\n\n\n\t\tthis._service\n\t\t\t.cadastra(negociacao)\n\t\t\t.then(mensagem => {\n\t\t\t\tthis._listaNegociacoes.add(negociacao);\n\t\t\t\tthis._mensagem.texto = mensagem;\n\t\t\t\tthis._mensagem.classe = \"alert alert-success\";\n\t\t\t\tthis._limpaForm();\n\t\t\t})\n\t\t\t.catch(erro => {\n\t\t\t\tthis._mensagem.texto = erro;\n\t\t\t\tthis._mensagem.classe = \"alert alert-danger\";\n\t\t\t})\n\t}\n\n\timportaAllNegociacoes() {\n\t\tthis._service\n\t\t\t.importa(this._listaNegociacoes.negociacao)\n\t\t\t.then(negociacoes =>\t\n\t\t\t\tnegociacoes.forEach( negociacao => {\n\t\t\t\t\tthis._listaNegociacoes.add(negociacao);\n\t\t\t\t\tthis._mensagem.texto = \"Negociações importadas com sucesso\";\n\t\t\t\t\tthis._mensagem.classe = \"alert alert-success\";\n\t\t\t\t})\n\t\t\t)\n\t\t\t.catch(erro => {\n\t\t\t\tthis._mensagem.texto = erro;\n\t\t\t\tthis._mensagem.classe = \"alert alert-danger\";\n\t\t\t})\n\n\t}\n\n\timportaEssaSemanaNegociacoes() {\n\n\t\tthis._service\n\t\t\t.getNegociacaoSemana()\n\t\t\t.then(negociacoes => {\n\t\t\t\tnegociacoes.forEach((negociacao) => this._listaNegociacoes.add(negociacao))\n\t\t\t\tthis._mensagem.texto = \"Negociações da semana importadas com sucesso\";\n\t\t\t\tthis._mensagem.classe = \"alert alert-success\";\n\t\t\t})\n\t\t\t.catch(erro => {\n\t\t\t\tthis._mensagem.texto = erro;\n\t\t\t\tthis._mensagem.classe = \"alert alert-danger\";\n\t\t\t});\n\n\t}\n\n\timportaSemanaPassadaNegociacoes() {\n\n\t\tthis._service\n\t\t\t.getNegociacaoSemanaPassada()\n\t\t\t.then(negociacoes => {\n\t\t\t\tnegociacoes.forEach((negociacao) => this._listaNegociacoes.add(negociacao))\n\t\t\t\tthis._mensagem.texto = \"Negociações da semana passada importadas com sucesso\";\n\t\t\t\tthis._mensagem.classe = \"alert alert-success\";\n\t\t\t})\n\t\t\t.catch(erro => {\n\t\t\t\tthis._mensagem.texto = erro;\n\t\t\t\tthis._mensagem.classe = \"alert alert-danger\";\n\t\t\t});\n\t}\n\n\timportaSemanaRetrasadaNegociacoes() {\n\n\t\tthis._service\n\t\t\t.getNegociacaoSemanaRetrasada()\n\t\t\t.then(negociacoes => {\n\t\t\t\tnegociacoes.forEach((negociacao) => this._listaNegociacoes.add(negociacao))\n\t\t\t\tthis._mensagem.texto = \"Negociações da semana retrasada importadas com sucesso\";\n\t\t\t\tthis._mensagem.classe = \"alert alert-success\";\n\t\t\t})\n\t\t\t.catch(erro => {\n\t\t\t\tthis._mensagem.texto = erro;\n\t\t\t\tthis._mensagem.classe = \"alert alert-danger\";\n\t\t\t});\n\t}\n\n\tapaga() {\n\n\t\tthis._service\n\t\t\t.apaga()\n\t\t\t.then(mensagem => {\n\t\t\t\tthis._mensagem.texto = mensagem;\n\t\t\t\tthis._mensagem.classe = \"alert alert-warning\";\n\t\t\t\tthis._listaNegociacoes.clear();\n\t\t\t})\n\t\t\t.catch(erro => {\n\t\t\t\tthis._mensagem.texto = erro;\n\t\t\t\tthis._mensagem.classe = \"alert alert-danger\";\n\t\t\t});\n\n\t}\n\n\tordena(coluna) {\n\t\tif (this._ordemAtual == coluna) {\n\t\t\tthis._listaNegociacoes.ordenaReverso();\n\t\t} else {\n\t\t\tthis._listaNegociacoes.ordena((a, b) => a[coluna] - b[coluna]);\n\t\t}\n\t\tthis._ordemAtual = coluna;\n\t}\n\n\t_criaNegociacao() {\n\t\treturn new Negociacao(\n\t\t\tDateHelper.StringToDate(this._data.value),\n\t\t\tparseInt(this._quantidade.value),\n\t\t\tparseFloat(this._valor.value)\n\t\t);\n\t}\n\n\t_limpaForm() {\n\n\t\tthis._data.value = \"\";\n\t\tthis._quantidade.value = 1;\n\t\tthis._valor.value = 0.0;\n\n\t\tthis._data.focus();\n\n\t}\n}\n\nlet negociacaoController = new NegociacaoController();\n\nexport function currentInstance() {\n\treturn negociacaoController;\n}"]}